# Plot NMR data using MATLAB
## Scripts – in subfolder "call"
- plot_stack.m : Fig. 2a,c,e. Calls load13CData and plotStacks; scales the time axis of the stack to align with the onset time and rate of metabolism, then plots the stack and 1D endpoint spectra. Requires both the 13C and 1H spectra to be processed and to share the same file stem. Note: Fig. 2b,d,f are generated by the Python script trajectories.py, with plot=True.  
- plot_flux.m : Fig. 3a,c-i. Calls plotGroupedRxns; takes the Excel table output from dfba.py, nmr-cdiff/data/fluxes.xlsx, and plots as lines, optionally displaying error regions.  
- plot_metflux.m : Fig. 3b. Calls plotFluxBidirectional; the metabolite-specific fluxes atpflux_in.txt and atpflux_out.txt must be processed manually into an Excel table, atpflux.xlsx, with sheets “in” and “out”. This script saves the resulting data as an area plot.  
- traces_Ala.m : Fig. 5a,c. Calls plotAlaTraces; reads Excel file with two sheets. The first sheet is the 13C experiment and the second is the 13C-15N experiment. Each should contain one ppm-shift column and three signal columns for the replicates. The script plots the 1D alanine alpha carbon traces with splitting overlays.
- stack_Ala.m : Fig. 5b,d. Calls plotRegionsAla; plots waterfall of alanine time series with color labeling.

## Functions
1. getColor : retreive colors for visualizations  
2. getTimescale : normalize timescale of experiment using 1H spectrum, analogous to synchrnoizers.py  
3. load13CData : load Excel output from process.py for plotting  
4. plotAlaTraces : plot the splitting patterns of alanine, as in Fig. 5  
5. plotFluxBidirectional : plot fluxes of competing reactions, stacked. Takes output from dfba.py (`fluxes.xlsx`). See Figure 3b.  
6. plotGroupedRxns : plot fluxes of key reactions, as in Fig. 3a,c-i  
7. plotRegionAla : plot NMR stack of alanine time series with color-coded peaks  
8. plotStacks : plot NMR stack as a surface plot with color-labeled ridges. See Figure 2a,c,e.  

## Usage
Some of these functions, especially plotStacks, use a large amount of memory. For best results, call the functions in batch mode from the command line.